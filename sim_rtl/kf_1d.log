ncsim> source /CMC/tools/cadence/INCISIVE15.20.079_lnx86/tools/inca/files/ncsimrc
ncsim> run
========================================
1D Kalman Filter Algorithm Test
Per paper Section 3: KF equations
========================================
[ROM] Programming 1D Kalman Filter...
[ROM] Programmed 25 instructions for 1D Kalman Filter

--- Loading KF parameters ---
  Phi = 1.0 (0x004000) -> DB[2]
  Q = 0.01 (0x0000a4) -> DB[3]
  R = 0.1 (0x000666) -> DB[4]
  x0 = 0.0 (0x000000) -> DB[0]
  P0 = 1.0 (0x004000) -> DB[1]
  y = 2.5 (0x00a000) -> DB[5]

--- Executing Kalman Filter ---
Waiting for computation to complete...
  Cycle   0: PC= 7, READY=0
  Cycle  10: PC=13, READY=0
  Cycle  20: PC=13, READY=0
  Cycle  30: PC=13, READY=0
  Cycle  40: PC=18, READY=0
  KF computation completed at cycle          49

========================================
Results
========================================
  x_hat (DB[0]) = 0.000000 (0x000000)
  P     (DB[1]) = 1.000000 (0x004000)
  Phi   (DB[2]) = 1.000000 (0x004000)
  Q     (DB[3]) = 0.010010 (0x0000a4)
  R     (DB[4]) = 0.099976 (0x000666)
  y     (DB[5]) = 2.500000 (0x00a000)
  P_pred(DB[6]) = 0.000000 (0x000000)
  tmp   (DB[7]) = 0.000000 (0x000000)

========================================
Expected (manual calculation)
========================================
  P_pred = P+Q = 1.0+0.01 = 1.01
  K = P_pred/(P_pred+R) = 1.01/1.11 = 0.9099
  x_hat = x + K(y-x) = 0 + 0.9099*2.5 = 2.275

========================================
1D Kalman Filter Test Complete
========================================

Simulation complete via $finish(1) at time 876 NS + 0
../src/kf_1d_tb.v:379     $finish;
ncsim> exit
